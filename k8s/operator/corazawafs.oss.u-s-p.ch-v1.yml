# Generated by Fabric8 CRDGenerator, manual edits might get overwritten!
apiVersion: "apiextensions.k8s.io/v1"
kind: "CustomResourceDefinition"
metadata:
  name: "corazawafs.oss.u-s-p.ch"
spec:
  group: "oss.u-s-p.ch"
  names:
    kind: "CorazaWaf"
    plural: "corazawafs"
    singular: "corazawaf"
  scope: "Namespaced"
  versions:
  - name: "v1alpha1"
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              backend:
                description: "Backend || required"
                properties:
                  hostname:
                    description: "Backend Service hostname || required"
                    pattern: "."
                    type: "string"
                  port:
                    description: "Backend port number || required, min 1, max 65535"
                    maximum: 65535.0
                    minimum: 1.0
                    type: "integer"
                required:
                - "hostname"
                - "port"
                type: "object"
              crs:
                description: "OWASP Core Rule Set (CRS) settings (version 4.18.0)"
                properties:
                  enabledRequestRules:
                    description: "Set of request rule classes (default is to include\
                      \ all rules, rules REQUEST_901_INITIALIZATION and REQUEST_949_BLOCKING_EVALUATION\
                      \ are always included, see https://github.com/coreruleset/coreruleset/tree/v4.18.0/rules\
                      \ for all configurable values, just replace '-' by '_' and omit\
                      \ '.conf')"
                    items:
                      enum:
                      - "REQUEST_911_METHOD_ENFORCEMENT"
                      - "REQUEST_913_SCANNER_DETECTION"
                      - "REQUEST_920_PROTOCOL_ENFORCEMENT"
                      - "REQUEST_921_PROTOCOL_ATTACK"
                      - "REQUEST_922_MULTIPART_ATTACK"
                      - "REQUEST_930_APPLICATION_ATTACK_LFI"
                      - "REQUEST_931_APPLICATION_ATTACK_RFI"
                      - "REQUEST_932_APPLICATION_ATTACK_RCE"
                      - "REQUEST_933_APPLICATION_ATTACK_PHP"
                      - "REQUEST_934_APPLICATION_ATTACK_GENERIC"
                      - "REQUEST_941_APPLICATION_ATTACK_XSS"
                      - "REQUEST_942_APPLICATION_ATTACK_SQLI"
                      - "REQUEST_943_APPLICATION_ATTACK_SESSION_FIXATION"
                      - "REQUEST_944_APPLICATION_ATTACK_JAVA"
                      type: "string"
                    type: "array"
                  enabledResponseRules:
                    description: "Set of response rule classes (default is to include\
                      \ no rules, rules RESPONSE_959_BLOCKING_EVALUATION and RESPONSE_980_CORRELATION\
                      \ are always included, see https://github.com/coreruleset/coreruleset/tree/v4.18.0/rules\
                      \ for all configurable values, just replace '-' by '_' and omit\
                      \ '.conf')"
                    items:
                      enum:
                      - "RESPONSE_950_DATA_LEAKAGES"
                      - "RESPONSE_951_DATA_LEAKAGES_SQL"
                      - "RESPONSE_952_DATA_LEAKAGES_JAVA"
                      - "RESPONSE_953_DATA_LEAKAGES_PHP"
                      - "RESPONSE_954_DATA_LEAKAGES_IIS"
                      - "RESPONSE_955_WEB_SHELLS"
                      - "RESPONSE_956_DATA_LEAKAGES_RUBY"
                      type: "string"
                    type: "array"
                  mode:
                    default: "BLOCK"
                    description: "Mode (DETECT = traffic identified as suspicious\
                      \ is logged but not blocked; BLOCK = traffic identified as suspicious\
                      \ is blocked) || default BLOCK"
                    enum:
                    - "BLOCK"
                    - "DETECT"
                    pattern: "(BLOCK|DETECT)"
                    type: "string"
                  paranoiaLevel:
                    description: "Paranoia level (the higher the level the better\
                      \ the protection but also more likely false positives, see OWASP\
                      \ CRS for details)"
                    properties:
                      detecting:
                        default: 1
                        description: "Reporting Paranoia level it's always at least\
                          \ as the enforcing paranoia Level. || default 1, min 1,\
                          \ max 4"
                        maximum: 4.0
                        minimum: 1.0
                        type: "integer"
                      enforcing:
                        default: 1
                        description: "Enforcing Paranoia level (the higher the level\
                          \ the better the protection but also more likely false positives,\
                          \ see OWASP CRS for details) || default 1, min 1, max 4"
                        maximum: 4.0
                        minimum: 1.0
                        type: "integer"
                    type: "object"
                  pathSettings:
                    description: "Path specific settings for allowed Method or Content-Types,\
                      \ etc."
                    items:
                      properties:
                        allowedContentType:
                          description: "Additionally allowed Content-Types for this\
                            \ Path (Exception for Rule 920420)"
                          type: "string"
                        allowedMethods:
                          description: "A list of allowed HTTP Methods for this Path\
                            \ (Rule 911100)"
                          items:
                            enum:
                            - "ACL"
                            - "BASELINE_CONTROL"
                            - "BIND"
                            - "CHECKIN"
                            - "CHECKOUT"
                            - "CONNECT"
                            - "COPY"
                            - "DELETE"
                            - "GET"
                            - "HEAD"
                            - "LABEL"
                            - "LINK"
                            - "LOCK"
                            - "MERGE"
                            - "MKACTIVITY"
                            - "MKCALENDAR"
                            - "MKCOL"
                            - "MKREDIRECTREF"
                            - "MKWORKSPACE"
                            - "MOVE"
                            - "OPTIONS"
                            - "ORDERPATCH"
                            - "PATCH"
                            - "POST"
                            - "PRI"
                            - "PROPFIND"
                            - "PROPPATCH"
                            - "PUT"
                            - "REBIND"
                            - "REPORT"
                            - "SEARCH"
                            - "TRACE"
                            - "UNBIND"
                            - "UNCHECKOUT"
                            - "UNLINK"
                            - "UNLOCK"
                            - "UPDATE"
                            - "UPDATEREDIRECTREF"
                            - "VERSION_CONTROL"
                            type: "string"
                          type: "array"
                        contentTypeParser:
                          description: "Request Body parser to use for this content-type"
                          enum:
                          - "JSON"
                          - "MULTIPART"
                          - "URLENCODED"
                          - "XML"
                          type: "string"
                        path:
                          description: "Path to which these settings applies. || required"
                          type: "string"
                      required:
                      - "path"
                      type: "object"
                    type: "array"
                  requestAnomalyScore:
                    default: 5
                    description: "Defines under which conditions suspicious requests\
                      \ are blocked; only has an effect if the mode is set to BLOCK\
                      \  || default 5, min 1"
                    minimum: 1.0
                    type: "integer"
                  requestRuleExceptions:
                    description: "Conditionally disable request rules to avoid false\
                      \ positive alerts/blocks"
                    items:
                      properties:
                        path:
                          description: "Path to which this exception is applied."
                          type: "string"
                        requestPartName:
                          description: "Request part name (e.g. 'User-Agent'; only\
                            \ has an effect if request rule exception)"
                          type: "string"
                        requestPartType:
                          description: "Request part type (only has an effect if request\
                            \ rule exception)"
                          type: "string"
                        ruleIds:
                          description: "A list of Rule IDs || required"
                          items:
                            type: "integer"
                          type: "array"
                      type: "object"
                    type: "array"
                  responseAnomalyScore:
                    default: 4
                    description: "Defines under which conditions suspicious responses\
                      \ are blocked; only has an effect if the mode is set to BLOCK\
                      \  || default 4, min 1"
                    minimum: 1.0
                    type: "integer"
                  responseRuleExceptions:
                    description: "Conditionally disable response rules to avoid false\
                      \ positive alerts/blocks"
                    items:
                      properties:
                        path:
                          description: "Path"
                          type: "string"
                        ruleIds:
                          description: "A list of Rule IDs || required"
                          items:
                            type: "integer"
                          type: "array"
                      type: "object"
                    type: "array"
                type: "object"
              parseJson:
                default: true
                description: "Whether to apply CRS protection rules for JSON payloads\
                  \ or not; must be true if GraphQL is enabled on any route || default\
                  \ true"
                type: "boolean"
              requestBodyAccess:
                default: true
                description: "Whether to scan request bodies or not, must be true\
                  \ if GraphQL is enabled on any route (if this setting is disabled,\
                  \ POST parameters and other content submitted in the request body\
                  \ will not be inspected) || default true"
                type: "boolean"
              requestBodyLimitAction:
                default: "Reject"
                description: "How to handle requests with a larger body than specified\
                  \ in coraza.requestBodyLimitKb (ProcessPartial = validate request\
                  \ body up to limit, let additional bytes through unchecked; Reject\
                  \ = reject request if body is larger than limit) || default ProcessPartial"
                enum:
                - "ProcessPartial"
                - "Reject"
                pattern: "(ProcessPartial|Reject)"
                type: "string"
              requestBodyLimitKb:
                default: 128
                description: "Request body limit in KB, body bytes beyond the limit\
                  \ are not parsed (also make sure that operation.bufferLimitBytes\
                  \ is set accordingly) || default 128, min 0, max 1048576"
                maximum: 1048576.0
                minimum: 0.0
                type: "integer"
              responseBodyAccess:
                default: false
                description: "Whether to scan response bodies or not; only allowed\
                  \ to set to false if coraza.crs.enabledResponseRules is empty (GraphQL\
                  \ does so far not parse response bodies, the backend is trusted)\
                  \ || default false"
                type: "boolean"
              responseBodyLimitAction:
                default: "Reject"
                description: "How to handle responses with a larger body than specified\
                  \ in coraza.responseBodyLimitKb (ProcessPartial = validate response\
                  \ body up to limit, let additional bytes through unchecked; Reject\
                  \ = reject response if body is larger than limit) || default ProcessPartial"
                enum:
                - "ProcessPartial"
                - "Reject"
                pattern: "(ProcessPartial|Reject)"
                type: "string"
              responseBodyLimitKb:
                default: 256
                description: "Response body limit in KB, body bytes beyond the limit\
                  \ are not parsed(also make sure that operation.bufferLimitBytes\
                  \ is set accordingly) || default 256, min 0, max 1048576"
                maximum: 1048576.0
                minimum: 0.0
                type: "integer"
              validateJson:
                default: true
                description: "Special rule which checks the syntax of JSON requests\
                  \ (if the syntax is invalid and the current mode is BLOCK, such\
                  \ requests are blocked); if set to true, across all routes with\
                  \ effectively enabled CRS and/or GraphQL only either mode BLOCK\
                  \ or DETECT must be used || default true"
                type: "boolean"
            required:
            - "backend"
            type: "object"
          status:
            properties:
              configMapName:
                type: "string"
              deploymentName:
                type: "string"
              errorMessage:
                type: "string"
              serviceName:
                type: "string"
            type: "object"
        type: "object"
    served: true
    storage: true
    subresources:
      status: {}
